<ng-container [ngSwitch]="variant">
  <section class="bg-light pt-3 pb-5" [attr.aria-labelledby]="'carousel-title'">
    <div class="container">
      <header class="heading heading-flex heading-border mb-3">
        <div class="heading-left">
          <h2 class="title m-0" [id]="'carousel-title'">{{ title }}</h2>
        </div>
      </header>

      <div class="tab-content tab-content-carousel">
        <div class="tab-pane p-0 fade show active" id="hot-all-tab" role="tabpanel" aria-labelledby="hot-all-link">

          <!-- 游뚽 Solo renderiza el carrusel cuando hay datos -->
          <ng-container *ngIf="elements?.length; else skeleton">

            <!-- Lista sem치ntica del carrusel -->
            <div
              #owlEl
              class="owl-carousel owlprod owl-simple carousel-equal-height carousel-with-shadow"
              role="list"
              data-owl-options='{
                "nav": false,
                "dots": true,
                "margin": 20,
                "loop": false,
                "responsive": {
                  "0":   { "items": 2 },
                  "480": { "items": 2 },
                  "768": { "items": 3 },
                  "992": { "items": 4 },
                  "1280":{ "items": 5, "nav": true }
                }
              }'>

              <!-- Producto -->
              <article
                class="product"
                *ngFor="let product of elements; trackBy: trackById"
                role="listitem"
                itemscope
                itemtype="https://schema.org/Product">

                <figure class="product-media">
                  <span class="product-label label-sale" >Promoci칩n</span>

                  <a [routerLink]="['/product', product.slug]" [attr.aria-label]="product.alt || product.name">
                    <!-- Usa dimensiones reales si las conoces para evitar CLS -->
                    <img
                      class="product-image"
                      ngSrc="{{ product.url }}"
                      [alt]="product.alt || product.name"
                      width="600" height="600"
                      decoding="async"
                      loading="lazy"
                      sizes="(max-width: 575.98px) 50vw, (max-width: 991.98px) 33vw, 20vw"
                      itemprop="image">
                  </a>

                  <div class="product-action">
                    <a
                      [routerLink]="['/product', product.slug]"
                      class="btn btn-primary w-100 btnverprod"
                      [attr.title]="'Ver producto: ' + product.name"
                      [attr.aria-label]="'Ver producto: ' + product.name">
                      <span>Ver producto</span>
                    </a>
                  </div>
                </figure>

                <div class="product-body">
                  <div class="product-cat" *ngIf="product.category_name">
                    <a
                      [routerLink]="['/category', product.cat_ref]"
                      [attr.aria-label]="'Ver categor칤a: ' + product.category_name">
                      {{ product.category_name }}
                    </a>
                  </div>

                  <h3 class="product-title" itemprop="name">
                    <a [routerLink]="['/product', product.slug]">
                      {{ truncateText(product.name, 75) }}
                    </a>
                  </h3>

                  <!-- Precios + Offer microdata -->
                  <div class="product-price mt-1" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
                    <meta itemprop="priceCurrency" content="COP">
                    <link itemprop="availability" href="https://schema.org/InStock" *ngIf="product.inStock">
                    <span class="new-price" itemprop="price"
                          [attr.content]="product.pricemostrar">
                      {{ product.pricemostrar | currency:'COP':'symbol':'1.0-0':'es-CO' }}
                    </span>
                    <span class="old-price" *ngIf="product.pricemostrartachado">
                      {{ product.pricemostrartachado | currency:'COP':'symbol':'1.0-0':'es-CO' }}
                    </span>
                  </div>

                  <!-- Ratings accesibles -->
                  <div class="ratings-container" *ngIf="product.rating">
                    <div class="ratings" [attr.aria-label]="'Valoraci칩n: ' + product.rating + ' de 5'">
                      <div class="ratings-val" [style.width.%]="(product.rating / 5) * 100"></div>
                    </div>
                    <span class="ratings-text" *ngIf="product.reviewsCount">
                      ({{ product.reviewsCount }} rese침as)
                    </span>
                  </div>

                  <!-- Descripci칩n corta para SEO (opcional) -->
                  <meta itemprop="description" [content]="product.shortDescription || product.name">
                  <meta itemprop="sku" [content]="product.sku">
                </div>
              </article><!-- .product -->
            </div><!-- .owl-carousel -->
          </ng-container>

          <!-- Skeleton mientras carga -->
          <ng-template #skeleton>
            <div class="d-flex gap-3" role="status" aria-live="polite" aria-busy="true">
              <div class="skeleton-card" *ngFor="let i of [1,2,3,4,5]"
                   style="width:200px;height:300px;background:#eee;border-radius:8px;"></div>
            </div>
          </ng-template>

        </div><!-- .tab-pane -->
      </div><!-- .tab-content -->
    </div><!-- .container -->
  </section><!-- .bg-light -->
</ng-container>
